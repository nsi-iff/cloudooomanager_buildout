#!/bin/bash
# RestMQ

# process' user and group

# twisted reactor (select, poll, epoll, kqueue)
REACTOR=epoll

# pidfile and logfile
PIDFILE=${restmq:pidfile}
LOGFILE=${restmq:logfile}

# redis host, port and connection pool size
REDIS_HOST=${restmq:redis_host}
REDIS_PORT=${restmq:redis_port}
REDIS_POOL=10

# server port, and interface to listen on
PORT=${restmq:port}
LISTEN=${restmq:host}

# run in foreground, for testing
# exec twistd -n restmq $*

# run in background, for production
export PYTHONPATH=`dirname $0`:$PYTHONPATH
exec ${buildout:bin-directory}/twistd --pidfile=$PIDFILE --logfile=$LOGFILE --reactor=$REACTOR \
   restmq --redis-host=$REDIS_HOST --redis-port=$REDIS_PORT --redis-pool=$REDIS_POOL \
   --port=$PORT --listen=$LISTEN

